version: "2.0"
rules:
- rule: Say goodbye anytime the user says goodbye
  steps:
  - intent: goodbye
  - action: utter_goodbye
- rule: Say 'I am a bot' anytime the user challenges
  steps:
  - intent: bot_challenge
  - action: utter_iamabot
- rule: Untitled Rule
  steps:
  - intent: greet
  - action: utter_greet

- rule: Manually trigger the ask number validation loop
  steps:
  - intent: trigger_ask_number
  - action: utter_ask_number

- rule: Validate the user's input
  condition:
  - slot_was_set:
    - is_retry_limit: False
  steps:
  - intent: inform
  - action: action_validate_user_input

- rule: Already reached retry limit
  condition:
  - slot_was_set:
    - is_retry_limit: True
  steps:
  - action: action_validate_user_input
  - action: utter_try_something_else

- rule: Successfully validated
  condition:
  - slot_was_set:
    - is_retry_limit: False
  steps:
    - action: action_validate_user_input
    - slot_was_set:
       - is_validated: True
    - action: utter_validate

# this is a dummy rule just to not get this warning:
# /opt/venv/lib/python3.8/site-packages/rasa/shared/utils/io.py:97: UserWarning: Action 'action_validate_user_input' set slot type 'bool' which it never set during the training. This can throw off the prediction. Make sure to include training examples in your stories for the different types of slots this action can return. Remember: you need to set the slots manually in the stories by adding the following lines after the action:

# - action: action_validate_user_input
# - slot_was_set:
#   - is_retry_limit: True

#   More info at https://rasa.com/docs/rasa/domain#slots
- rule: Unsuccessfully validated
  condition:
  - slot_was_set:
    - is_retry_limit: False
  steps:
    - action: action_validate_user_input
    - slot_was_set:
       - is_validated: False
       - is_retry_limit: False
    - action: utter_validate
